function clearHighlight(){$highlight("body").highlightRegex({tagType:"span",className:"highlighter"})}function filterKeywords(e){var t=e.replace(/(^\s*,)|(,\s*$)/g,""),n=t.split(",");return n}function loadKeywords(){storage.get("keywords",function(e){if(e.keywords){var t=JSON.parse(e.keywords);if(t){var n=filterKeywords(t);highlight(n)}}})}var keywords,highlighted=!1,storage=chrome.storage.local,$highlight=jQuery.noConflict();highlight=function(e){for(var t=0;t<e.length;t++)e[t]="("+e[t]+")";words=e.join("|");var n=new RegExp(words,"i"),r=(new Date).getTime();$highlight("body").highlightRegex(n,{tagType:"span",className:"highlighter",palette:["yellow","blue","green","red","turq","orange","purple","pink","lilac","silver"]});$highlight(":input,:text").highlightRegex({tagType:"span",className:"highlighter"});var i=(new Date).getTime();console.log("highlighter: "+(i-r)+"ms");chrome.extension.sendRequest({},function(e){})};highlightHeartbeat=function(){var e=keywords;if(e){var t=filterKeywords(e);highlight(t)}};chrome.extension.onMessage.addListener(function(e,t,n){if(e.command=="unhighlight")clearHighlight();else if(e.command=="rehighlight")loadKeywords();else if(e.command=="rehighlightall"){clearHighlight();loadKeywords()}n({message:"done"})});chrome.storage.onChanged.addListener(function(e,t){for(key in e)if(key=="keywords"){var n=e[key];keywords=JSON.parse(n.newValue);clearHighlight();highlightHeartbeat()}});