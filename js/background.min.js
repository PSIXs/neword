//page_action icon
function onRequest(e,t,n){chrome.pageAction.show(t.tab.id);chrome.contextMenus.create({title:"Highlight selection",contexts:["selection"],onclick:function(e){if(e.selectionText){var t=chrome.storage.local;t.get("keywords",function(n){if(n.keywords){keywordList=JSON.parse(n.keywords);keywordList=keywordList+","+e.selectionText;keywordList=JSON.stringify(keywordList);t.set({keywords:keywordList},function(){})}})}}});n({})}function onMessageExternal(e,t,n){e.command=="isHighlighterInstalled"&&n({message:"isHighlighterInstalled"})}chrome.extension.onRequest.addListener(onRequest);chrome.tabs.onUpdated.addListener(function(e,t,n){n.status=="complete"&&chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{command:"rehighlightall"},function(e){})})});chrome.extension.onMessageExternal.addListener(onMessageExternal);